\chapter{Introduction}
\section{Plasma}
Plasma is often called the fourth state of matter after solid, liquid, and gas. \cite{chen_introduction_2016} In a plasma, the atoms or molecules have been stripped of electrons, resulting in a collection of charged particles, ions and electrons.

\begin{figure}[htbp]
	\centering
	\includegraphics[width=0.7\textwidth]{figures/plasma-properties}
	\caption{Typical plasmas. Adapted from \cite{cpep_physics}}
	\label{fig:plasma-properties}
\end{figure}

Plasma is a common state of matter, some examples are listed on Fig.~\ref{fig:plasma-properties}. Natural plasmas include nebula, solar wind, aurora, etc. These natural plasmas seen in the sky because they are in plasma state, and plasma is capable of emitting light. \cite{chen_introduction_2016} Plasma has various scientific and technology uses. The artificially generated plasma can be found in fluorescent lights, Neon signs, etc. It can also be found in plasma physics research, nuclear fusion experiments, plasma cutting and welding, plasma medicine for treating diseases, and even in spacecraft propulsion systems. Overall, plasma is an intriguing and versatile state of matter with significant implications in various fields of science, technology, and industry.

\subsection{Definition of Plasma}
Simply put, a plasma is a quasineutral gas of charged and neutral particles which exhibits collective behavior. \cite{chen_introduction_2016} Before we give a more precise definition of plasma, some concepts must be introduced.

\subsubsection*{Debye Shielding and Quasineutrality}
A fundamental property of plasma is its ability to shield externally applied electric field. \cite{chen_introduction_2016} Imagine two balls are connected to a battery, and they are charged. When these charged balls are submerged into a plasma, the ions will surround the positively charged ball, and the electrons will surround the negatively charged ball. See Fig.~\ref{fig:debye-shielding}. Suppose there are sufficient amounts of ions and electrons in the plasma, and the plasma is cold (no thermal motions) the electric field generated by the two balls will be shielded out by the surrounding ion and electron clouds. If the plasma has finite temperature, then the edge of the cloud occurs at the radius where the potential energy is approximately equal to the thermal energy $KT$ of the particles, and the shielding is not complete.

\begin{figure}[htbp]
	\centering
	\includegraphics[width=0.7\textwidth]{figures/debye-shielding.png}
	\caption{Debye shielding. Adapted from \cite{chen_introduction_2016}. Two charged balls are submerged into a plasma. Ions will surround the positively charged ball, and the electrons will surround the negatively charged ball.}
	\label{fig:debye-shielding}
\end{figure}

To compute the thickness of the cloud, also known as the Debye length, we focus our view to the positively charged ball. Suppose the coordinate's origin is at the ball's center and $\phi(0)=0$. We will solve the following 1-dimensional Poisson's equation,
\begin{equation}
	\epsilon_0\dv[2]{\phi}{x} = -e(n_i - n_e), \quad \phi(0) = \phi_0
\end{equation}
where $n$ is the number density of the particles, and the subscripts $i$ and $e$ stand for ion and electron.

For simplicity, we assume massless electron, $m/M \to 0$. The solution to the Poisson's equation is
\begin{equation}
	\phi = \phi_0\exp(-\abs{x}/\lambda_D)
\end{equation}
where the quantity $\lambda_D$ is called Debye length, and is defined as
\begin{equation}
	\lambda_D \equiv \left(\frac{\epsilon_0 KT}{ne^2}\right)^{1/2}
	\label{eq:debye-length}
\end{equation}
where $n$ stands for the number density far away from the charged ball. The potential is shown in Fig.~\ref{fig:debye-potential}. The  Debye length characterizes the thickness the of the cloud.

\begin{figure}[htbp]
	\centering
	\includegraphics[width=0.7\textwidth]{figures/debye-potential.png}
	\caption{Potential distribution near a positively charged ball in a plasma. Adapted from \cite{chen_introduction_2016}}
	\label{fig:debye-potential}
\end{figure}

If the system size $L$ is much larger than the Debye length $\lambda_D$, then any electric field introduced to the plasma system will be shielded out in a tiny distance $\lambda_D$ compared to $L$. Hence, the plasma system remains electrically neutral if it is neutral initially. If a plasma is quasineutral, then one can take $n_i\simeq n_e$ (but not so neutral that all interesting electromagnetic forces vanish), and use the symbol $n$ to denote the common density and call it the plasma density.

\subsubsection*{Plasma Oscillation}
There are many kinds of oscillations in plasma, one of the most fundamental oscillations is the electron plasma oscillation. Imagine the ions are too heavy to move, and they form a uniform background. The electrons are then released from a distance away from the ions (Fig.~\ref{fig:plasma-oscillation}). The electric field will pull the electrons toward the ions, after the electrons pass the ions, the electric field will decelerate them and started to pull them on the other side. The frequency of this oscillation is called plasma frequency,
\begin{equation}
	\omega_p = \left(\frac{n_0e^2}{\epsilon_0m}\right)^{1/2}
\end{equation}

\begin{figure}[htbp]
	\centering
	\includegraphics[width=0.7\textwidth]{figures/plasma-oscillation.png}
	\caption{Mechanism of plasma oscillations. Adapted from \cite{chen_introduction_2016}.}
	\label{fig:plasma-oscillation}
\end{figure}

\subsubsection*{Criteria of Plasmas}
We are now able to give more detail definition for plasma. According to \cite{chen_introduction_2016}, not all ionized gas can be called plasma, there are three conditions a plasma must satisfy:
\begin{enumerate}
	\item Debye length is much smaller than the system size, $\lambda_D \ll L$.
	\item Collective behavior requires lots of particles in a Debye sphere, $N_D = n\frac{4\pi}{3}\lambda_D^3 \ggg 1$.
	\item The gas behaves like plasma rather than a neutral gas, $\omega_p\tau > 1$ where $\omega_p$ typical plasma oscillation frequency and $\tau$ is the mean free time of collisions between neutral atoms.
\end{enumerate}

\section{Instability of Plasma Flow} \label{sec:instability-of-plasma-flow}
The instability of plasma flow refers to the tendency of a plasma system to deviate from a stable, equilibrium state and exhibit perturbations or fluctuations in its behavior. It can be understood as the simple mechanical analogy with a ball on crest / in valley. On the left of Fig.~\ref{fig:stability-visualization} shows us a stable equilibrium, small perturbations given to the system will not push the ball far away from the equilibrium position, the valley. Hence, the equilibrium is stable. On the right, any small perturbations will cause the ball to fall downhill, hence the equilibrium is unstable. The instabilities in plasma can arise from various factors, such as the interaction of particles with electromagnetic fields, collective effects, or the presence of gradients in plasma parameters. A famous example of instability is the two stream instability. The configuration starts with two oppositely traveling beams of ions and electrons. As time evolves, chaotic behavior develops as shown in Fig.~\ref{fig:two-stream-instability}.

\begin{figure}[htbp]
	\centering
	\includegraphics[width=0.7\linewidth]{figures/stability-visualization.png}
	\caption{Mechanical analogy of various types of equilibrium. Adapted from \cite{chen_introduction_2016}}
	\label{fig:stability-visualization}
\end{figure}

\begin{figure}[htbp]
	\centering
	\includegraphics[width=0.7\linewidth]{figures/two-stream-instability}
	\caption{Visualization of two-stream instability in the phase space. (a) Initially the ion and electron flow are in opposite direction. (b) The velocity of both flows start to oscillate. (c) Chaotic behavior occurs. (d) The chaotic behavior continues. \cite{ha_nonlinear_2011}}
	\label{fig:two-stream-instability}
\end{figure}

Magnetic nozzle is one of the most actively researched configurations in plasma propulsion systems, which is being developed for space missions due to their potential for high efficiency and thrust. Understanding and controlling instabilities in the plasma flow within these nozzles is essential for optimizing their performance and achieving efficient propulsion. Investigating instabilities in plasma flow within magnetic nozzles also contributes to our broader understanding of fundamental plasma physics phenomena.


\subsection{Analysis of Linear Instability}
In this thesis, we will focus on the so-called linear instability. Meaning that the perturbation grows / decays only in exponential form. The following is a brief description of the process for analyzing linear instability. The detail treatment will be given in Chap.~\ref{chap:theoretical-analysis}.

\begin{enumerate}
	\item State equations of motion: The linear instability analysis starts from the equations of motion which describes the plasma system. In this thesis, the equations of motion are time-dependent fluid equations involving the number density $n$ and velocity $v$ of the plasma flow along the central axis of the nozzle.
	\item Give perturbations to the system: Suppose the system has an equilibrium state $n_0$ and $v_0$. The system will be given small perturbations, they serve as small deviations on number density and velocity, $\tilde{n}$ and $\tilde{v}$. All variables $n$ and $v$ in the equations of motion will be substituted by perturbed quantities, $n_0+\tilde{n}$ and $v_0+\tilde{v}$.
	\item Linearize equations of motion: Expand the equations of motion, and discard the second and higher order terms, often called nonlinear terms, such as $\tilde{n}\tilde{v}$, $\tilde{n}\partial_z\tilde{v}$, $\tilde{v}\partial_z\tilde{n}$ etc. We obtain the so-called linearized equations of motion. These equations contain only the linear terms.
	\item Assume perturbation takes exponential form: Let perturbations take the form $\exp(-i\omega t)$. This indicates that the perturbations are oscillating with frequency $\omega$ in time. Any time derivative in the linearized equations of motion simply becomes $\partial_t = -i\omega$. Now we obtain equations involving perturbations, $\tilde{n}$ and $\tilde{v}$, and their spatial derivatives, and $\omega$.
	\item Analyze the possible values of $\omega$: The oscillation frequency $\omega$ could be a complex number. If the imaginary part of the temporal frequency is greater than zero, i.e. $\Im(\omega) > 0$, then the system is unstable. This is because the perturbation grows exponentially $\exp(\Im(\omega)t)$ in time. On the other hand, if the imaginary part of the temporal frequency is less than or equal to zero, $\Im(\omega) \leq 0$, then the system is said to be stable. Since the perturbations will not be growing, $\Im(\omega)=0$, or even damped, $\Im(\omega) < 0$.
\end{enumerate}

In the later chapters, we devoted much effort to analyze the temporal frequency $\omega$. We will employ spectral method to analyze the temporal frequency for subsonic and supersonic velocity profiles, and shooting method will be employed to obtain temporal frequency.

\section{Magnetic Nozzle}
In this thesis, we are going to deal with plasma flow in magnetic nozzle.
A magnetic nozzle is a device that uses a magnetic field to shape and control the flow of charged particles in a plasma propulsion system, see Fig.~\ref{fig:magnetic-nozzle}. By employing magnetic mirrors, the magnetic nozzle can efficiently direct and accelerate the plasma particles, generating thrust for propulsion. The magnetic field in the nozzle helps collimate and focus the plasma exhaust, increasing its velocity and enhancing the performance of the propulsion system.

\begin{figure}[htbp]
	\centering
	\includegraphics[width=0.7\linewidth]{figures/magnetic-nozzle.png}
	\caption{A simplified example of a magnetic nozzle configuration. On the left ($z=-1$) is the entrance of the nozzle. The plasma flows into the nozzle from the left and will be accelerated and finally exhaust through the exit on the right ($z=1$). The magnetic field lines are shaped in such a way that it forms a magnetic mirror configuration. Plasma flow with specific subsonic speed at the entrance will be accelerated to supersonic speed.}
	\label{fig:magnetic-nozzle}
\end{figure}

\subsection{Magnetic Field in Magnetic Nozzle} \label{sec:magnetic-field-in-nozzle}
The magnetic nozzle by its nature is 3-dimensional. We assume the magnetic field is axis-symmetric, then the radial magnetic field and axial magnetic field are constraint by divergence-free condition,
\begin{equation}
	\div\mathbf{B} = \frac{1}{r}\pdv{(rB_r)}{r} + \pdv{B_z}{z} = 0
	\label{eq:divergence-free-condition}
\end{equation}
Since we are interested in the plasma flow near the central axis of the nozzle, with paraxial approximation taken, the derivative along the magnetic field line $\nabla_\parallel = \pdv*{z}$ when near the central axis. \cite{smolyakov_quasineutral_2021} Hence, in this thesis we will treat the flow in magnetic nozzle as a 1-dimensional problem. The axial magnetic field along the central axis is modeled as
\begin{equation}
	B_z(z) = B_0 \left[1 + R\exp(-\left(\frac{z}{\delta}\right)^2)\right], \quad -1\leq z \leq 1
\end{equation}
where $1+R$ is the magnetic mirror ratio, it is the ratio of the magnitude of magnetic field at the center of the nozzle to that at the end of the nozzle, $1+R = B(0)/B(1)$. The mirror ratio $R$ controls the spread of the plasma flow at the exit. On the other hand, $\delta$ determines the spread of the magnetic field. Larger the $\delta$, flatter the magnetic field. An example of magnetic field is shown in Fig.~(\ref{fig:magnetic-field}).

The radial profile of magnetic field, $B_r$, is given by the divergence-free condition, Eq.~(\ref{eq:divergence-free-condition}). In this thesis will focus on the axial magnetic field only.

\begin{figure}[htbp]
	\centering
	\includegraphics[width=0.7\linewidth]{figures/magnetic-field}
	\caption{This is the magnetic field in nozzle with mirror ratio $1+R=B_{max}/B_{min}=2.5$, and the spread of magnetic field, $\delta=0.1/0.3=0.\bar{3}$. }
	\label{fig:magnetic-field}
\end{figure}

\subsection{Velocity Profiles of Plasma Flow in Magnetic Nozzle}
The analytical solution gives 4 different kinds of velocity profiles,
\begin{itemize}
	\item Subsonic profile: Plasma flow enters and exits the nozzle with subsonic speed. Every point on this profile is subsonic.
	\item Supersonic profile: Plasma flow enters and exits the nozzle with supersonic speed. Every point on this profile is supersonic.
	\item Accelerating profile: Plasma flow enters the nozzle with subsonic speed and exits the nozzle with supersonic speed. Points before the nozzle throat are subsonic, and the flow reaches ion sound speed at the nozzle throat, then the flow is supersonic after the nozzle throat.
	\item Decelerating profile: Plasma flow enters the nozzle with supersonic speed and exits the nozzle with subsonic speed. Similar to the accelerating profile, but the velocity is decreasing.
\end{itemize}
See Fig.~\ref{fig:velocity-profiles} for these profiles.

The velocity of plasma flow in the magnetic nozzle is given by the Lambert W function, Eq.~(\ref{eq:velocity-profile}). The Lambert W function has 2 different branches. The $k=0$ branch corresponds to the subsonic parts in the velocity profile, and the $k=-1$ branch gives the supersonic parts. The expression of velocity profile will be derived in Chap.~\ref{chap:theoretical-analysis} and more details will be discussed.

\section{Flow in Similar Configuration: Bondi-Parker Flow}
Consider a massive celestial object in the space. This celestial object will attract matter in the space because it is massive. Hence, creating an accretion flow. If the celestial object is a star, it can also eject matter into space. Solar wind is an example to this since it is a stream of charged particles, primarily electrons and protons, flowing outward from the Sun. Bondi derived a steady-state solution for accretion flow which is governed by Bernoulli's equation in spherical symmetry around a point mass in 1952. Hence, the inward accretion flow is also called Bondi flow. Then Parker solved a similar problem but with outward wind in 1958. Then the outward wind is given the name, Parker flow. \cite{aikawa_stability_1979,bondi_spherically_1952,keto_stability_2020} The Bondi and Parker flow (also called Bondi-Parker flow) is similar to that in magnetic nozzle. It is interesting to compare the two configurations.

If we compare the velocity profiles for Bondi-Parker flow and the flow in magnetic nozzle. We found they are similar. The Bondi-Parker flow can also be grouped into the following types: subsonic, supersonic, and transonic (accelerating and decelerating). See Fig.~\ref{fig:BP-flow-velocity}. For subsonic profiles, every point on the curve is slower than sound speed. While every point on the supersonic velocity profile is faster than sound speed. Lastly, there are two different transonic profiles: accelerating profile and decelerating profile. The accelerating profile describes the accelerating plasma flow which is at subsonic speed at the mass point, e.g. a star, and is accelerated to supersonic speed far away. The decelerating profile shows that a plasma flow ejected supersonically from a mass point and then decelerated to subsonic speed far away.

The velocity profiles of one-dimensional, spherically symmetric, stationary isothermal Parker flow neglecting self-gravity can be expressed using Lambert W function,
\begin{equation}
	v(r) = \sqrt{-\frac{KT}{m}W_k\left[ -\left(\frac{r}{r_c}\right)^2 \exp\left[4\left(1-\frac{r_c}{r}\right)-1\right] \right]}, \quad
	k = 0,-1
\end{equation}
where $r$ stands for the distance measured from the center of the mass point, e.g. star. The position $r_c=GMm/2KT$ is the critical position and the velocity at this point is exactly the sonic speed $v(r_c)=\sqrt{KT/m}$, where $M$ is the mass of the mass point, $m$ is the mass of a single particle in the flow, and $T$ is the temperature of the flow. The Bondi flow is simply $-v(r)$ since it is accretion flow, the particles are flowing inwardly towards the mass point.

As we can see the expression of velocity profile for Bondi-Parker flow is similar to that of the magnetic nozzle, Eq.~(\ref{eq:velocity-profile}). The expression is governed by the Lambert W function. Similarly, the $k=0$ branch corresponds to the subsonic part in the velocity profile, and the $k=-1$ branch corresponds to the supersonic part of the profile.

\begin{figure}[htbp]
	\centering
	\includegraphics[width=0.7\textwidth]{figures/steady-state-BP-flow}
	\caption{Representative trajectories of the steady-state BP flow in non-dimensional units. The velocities are shown in absolute values. Adapted from \cite{keto_stability_2020}. The upward pink line represents an accelerating flow, it accelerates from subsonic to supersonic. The downward pink line represents a decelerating flow. The green lines below the pink lines represent subsonic flows, and the green lines above represent supersonic flows. Orange lines are physically impossible scenarios. If the sign of the velocity is positive, then it is an outward (Parker) flow, otherwise it is an inward (Bondi) flow.}
	\label{fig:BP-flow-velocity}
\end{figure}

The instabilities of the Bondi-Parker flow has been extensively studied. \cite{bbondi_spherically_1952,velli_from_1994,velli_hydrodynamics_2001,del_dynamical_1998,keto_stability_2020} Hopefully these studies can provide insights into our problem.

\section{Goals of this Thesis}
Fusion is considered the next-generation source of a clean, safe and abundant energy providing an opportunity to address climate change problems. A new high-tech industry has appeared in the last decade fueled by over \$4 billion of private investments, with the second world largest and several other smaller companies founded in Canada. To achieve controlled fusion, one of the key science problems is to understand and learn to predict the non-linear behavior of plasma due to waves and instabilities. The general objective of my research is to understand the behavior and learn to control the turbulent flows of plasmas in magnetically controlled fusion system, in particular, open magnetic mirrors. I study the instabilities of the flow in a magnetic mirror configuration under different boundary conditions which is an open question and is under debate in application to fusion systems and also related to the solar wind flows.

The general objective of this research is to understand the stability of the flow in a magnetic nozzle. Plasma confined by the magnetic field is typically far from the state of the thermodynamic equilibrium which makes it unstable. In this project, we would like to investigate the stability of plasma flow in a magnetic nozzle under different boundary conditions. Understanding the instabilities of plasma flow in a magnetic mirror configuration is important in applications such as the expanding magnetic divertors in controlled fusion and electric propulsion. \cite{ryutov_divertor_2016,kaganovich_2020_physics}

In the following thesis, fluid model of plasma will be reviewed and linearized governing equations will be derived in chapter \ref{chap:theoretical-analysis}. The problem will be then formulated as an eigenvalue problem. In chapter \ref{chap:spectral-method}, spectral method and shooting method for solving eigenvalue problem will be introduced. In the section of spectral method, different discretizations of the operators, such as finite difference and spectral method will be discussed. Moreover, spectral pollution and its filtering will as also be investigated. Then in the next section, we will formulate the problem to the form suitable for applying shooting method. We will apply both shooting method and spectral method to the problem. By comparing the results from two different methods, the credibility of the results are increased. In chapter \ref{chap:numerical-experiments}, we will use the method developed in chapter \ref{chap:spectral-method} to conduct numerical experiments. The goal is to extract the eigenvalues (frequency) of each oscillating mode. Conclusion will in chapter \ref{chap:discussion}.
